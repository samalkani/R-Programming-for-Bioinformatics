names(gene_expression)[names(gene_expression) == 'X'] <- 'Genes'
head(gene_expression, n = 1)
# Load Library
library(tidyr)
# Conversion of wide data set to a long data set
gene_expression <- pivot_longer(gene_expression, cols = c("control_rep1", "control_rep2", "treated_rep1", "treated_rep2"),
names_to = "sample", values_to = "expression_level")
head(gene_expression, n =1)
head(colData, n = 1)
gene_expression <- data.frame(Genes = gene_expression$Genes,
Condition = rep(colData$condition, times = 20000),
Replicate = rep(colData$replicate, times = 20000),
Sample = gene_expression$sample,
Expression_Level = gene_expression$expression_level)
head(gene_expression, n = 3)
ggplot(gene_expression, aes(x = Sample , y = Expression_level, fill = Condition)) +
geom_boxplot() +
theme_minimal() +
labs(title = "Gene Expression Levels Across Conditions")
# Example: Visualizing Gene Expression Data
gene_expression <- read.csv("gene_expression.csv")
head(gene_expression, n = 1)
# Change X column to Genes
names(gene_expression)[names(gene_expression) == 'X'] <- 'Genes'
head(gene_expression, n = 1)
# Load Library
library(tidyr)
# Conversion of wide data set to a long data set
gene_expression <- pivot_longer(gene_expression, cols = c("control_rep1", "control_rep2", "treated_rep1", "treated_rep2"),
names_to = "sample", values_to = "expression_level")
head(gene_expression, n =1)
head(colData, n = 1)
gene_expression <- data.frame(Genes = gene_expression$Genes,
Condition = rep(colData$condition, times = 20000),
Replicate = rep(colData$replicate, times = 20000),
Sample = gene_expression$sample,
Expression_Level = gene_expression$expression_level)
head(gene_expression, n = 3)
# Example: Visualizing Gene Expression Data
gene_expression <- read.csv("gene_expression.csv")
head(gene_expression, n = 1)
# Change X column to Genes
names(gene_expression)[names(gene_expression) == 'X'] <- 'Genes'
head(gene_expression, n = 1)
# Load Library
library(tidyr)
# Conversion of wide data set to a long data set
gene_expression <- pivot_longer(gene_expression, cols = c("control_rep1", "control_rep2", "treated_rep1", "treated_rep2"),
names_to = "sample", values_to = "expression_level")
head(gene_expression, n =1)
head(colData, n = 1)
gene_expression <- data.frame(Genes = gene_expression$Genes,
Condition = rep(colData$condition, times = 20000),
Replicate = rep(colData$replicate, times = 20000),
Sample = gene_expression$sample,
Expression_Level = gene_expression$expression_level)
head(gene_expression, n = 3)
ggplot(gene_expression, aes(x = Sample , y = Expression_Level, fill = Condition)) +
geom_boxplot() +
theme_minimal() +
labs(title = "Gene Expression Levels Across Conditions")
ggplot(gene_expression, aes(x = Sample , y = Expression_Level, fill = Condition)) +
geom_boxplot() +
theme_minimal() +
labs(title = "Gene Expression Levels Across Conditions",
x = "Sample",
y = "Expression Level",
fill = "Condition")
# Write csimulated counts data into aCSV file
write.csv(counts_scaled, file = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 9/counts.csv")
# Example: Visualizing Gene Expression Data
count_data <- read.csv("counts.csv")
head(count_data, n = 1)
# Change X column to Genes
names(gene_expression)[names(gene_expression) == 'X'] <- 'Genes'
head(gene_expression, n = 1)
# Change X column to Genes
names(count_data)[names(gene_expression) == 'X'] <- 'Genes'
head(count_data, n = 1)
# Change X column to Genes
names(count_data)[names(count_data) == 'X'] <- 'Genes'
head(count_data, n = 1)
View(count_data)
colData
colData
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = data.frame(condition = factor(c("Control", "Treatment"))),
design = ~ condition)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData,
design = ~ condition)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = data.frame(condition = factor(c("Control", "Treatment"))),
design = ~ condition)
# Example count matrix (genes as rows, samples as columns)
count_data <- matrix(
c(10, 50, 30, 80, 20, 60),  # counts
nrow = 3,                   # 3 genes
ncol = 2,                   # 2 samples
byrow = TRUE
)
rownames(count_data) <- c("gene1", "gene2", "gene3")
colnames(count_data) <- c("Control", "Treatment")
# Metadata for samples (must match column names of count_data)
col_data <- data.frame(
condition = factor(c("Control", "Treatment")),
row.names = colnames(count_data)
)
# Create DESeq2 dataset
dds <- DESeqDataSetFromMatrix(
countData = count_data,
colData = col_data,
design = ~ condition
)
# Run DESeq analysis
dds <- DESeq(dds)
# Create sample metadata
colData <- data.frame(
condition = factor(c("control", "control", "treated", "treated")),
replicate = c(1, 2, 1, 2)
)
rownames(colData) <- colnames(count_data)
# Create sample metadata
colData <- data.frame(
condition = factor(c("control", "control", "treated", "treated")),
replicate = c(1, 2, 1, 2)
)
rownames(colData) <- colnames(counts_scaled)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData))),
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData,
design = ~ condition)
# Create sample metadata
colData <- data.frame(
condition = factor(c("control", "control", "treated", "treated")),
replicate = c(1, 2, 1, 2)
)
rownames(colData) <- colnames(counts_scaled)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData,
design = ~ condition)
# Parameters
set.seed(42)  # reproducibility
n_genes <- 20000   # number of genes
n_samples <- 4     # 2 control, 2 treated
total_counts <- 1013912
# Simulate counts from a negative binomial distribution
raw_counts <- matrix(
rnbinom(n_genes * n_samples, mu = 50, size = 1/0.2),  # mean=50, dispersion=0.2
nrow = n_genes,
ncol = n_samples
)
head(raw_counts)
# Scale counts so total sum matches exactly 1,013,912
scale_factor <- total_counts / sum(raw_counts)
scale_factor
counts_scaled <- round(raw_counts * scale_factor)
head(counts_scaled)
# Assign gene IDs
rownames(counts_scaled) <- paste0("Gene", seq_len(n_genes))
colnames(counts_scaled) <- c("control_rep1", "control_rep2", "treated_rep1", "treated_rep2")
head(counts_scaled)
# Create sample metadata
colData <- data.frame(
condition = factor(c("control", "control", "treated", "treated")),
replicate = c(1, 2, 1, 2)
)
rownames(colData) <- colnames(counts_scaled)
head(counts_scaled)
# Write simulated counts data into a CSV file
write.csv(counts_scaled, file = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 9/counts.csv")
# Example: Visualizing Gene Expression Data
count_data <- read.csv("counts.csv")
head(count_data, n = 1)
# Change X column to Genes
names(count_data)[names(count_data) == 'X'] <- 'Genes'
head(count_data, n = 1)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData,
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData,
design = ~ condition)
# Assign gene IDs
rownames(counts_scaled) <- paste0("Gene", seq_len(n_genes))
# Parameters
set.seed(42)  # reproducibility
n_genes <- 20000   # number of genes
n_samples <- 4     # 2 control, 2 treated
total_counts <- 1013912
# Simulate counts from a negative binomial distribution
raw_counts <- matrix(
rnbinom(n_genes * n_samples, mu = 50, size = 1/0.2),  # mean=50, dispersion=0.2
nrow = n_genes,
ncol = n_samples
)
head(raw_counts)
# Scale counts so total sum matches exactly 1,013,912
scale_factor <- total_counts / sum(raw_counts)
scale_factor
counts_scaled <- round(raw_counts * scale_factor)
head(counts_scaled)
# Assign gene IDs
rownames(counts_scaled) <- paste0("Gene", seq_len(n_genes))
colnames(counts_scaled) <- c("control_rep1", "control_rep2", "treated_rep1", "treated_rep2")
head(counts_scaled)
# Create sample metadata
colData <- data.frame(
condition = factor(c("control", "control", "treated", "treated")),
replicate = c(1, 2, 1, 2)
)
rownames(colData) <- colnames(counts_scaled)
head(counts_scaled)
# Write simulated counts data into a CSV file
write.csv(counts_scaled, file = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 9/counts.csv")
# Example: Visualizing Gene Expression Data
count_data <- read.csv("counts.csv")
head(count_data, n = 1)
# Change X column to Genes
names(count_data)[names(count_data) == 'X'] <- 'Genes'
head(count_data, n = 1)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData,
design = ~ condition)
# Parameters
set.seed(42)  # reproducibility
n_genes <- 20000   # number of genes
n_samples <- 4     # 2 control, 2 treated
total_counts <- 1013912
# Simulate counts from a negative binomial distribution
raw_counts <- matrix(
rnbinom(n_genes * n_samples, mu = 50, size = 1/0.2),  # mean=50, dispersion=0.2
nrow = n_genes,
ncol = n_samples
)
head(raw_counts)
# Scale counts so total sum matches exactly 1,013,912
scale_factor <- total_counts / sum(raw_counts)
scale_factor
counts_scaled <- round(raw_counts * scale_factor)
head(counts_scaled)
# Assign gene IDs
rownames(counts_scaled) <- paste0("Gene", seq_len(n_genes))
colnames(counts_scaled) <- c("control_rep1", "control_rep2", "treated_rep1", "treated_rep2")
head(counts_scaled)
# Create sample metadata
colData <- data.frame(
condition = factor(c("control", "control", "treated", "treated")),
replicate = c(1, 2, 1, 2)
)
rownames(colData) <- colnames(counts_scaled)
head(counts_scaled)
# Write simulated counts data into a CSV file
write.csv(counts_scaled, file = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 9/counts.csv")
# Example: Visualizing Gene Expression Data
count_data <- read.csv("counts.csv")
head(count_data, n = 1)
# Change X column to Genes
names(count_data)[names(count_data) == 'X'] <- 'Genes'
head(count_data, n = 1)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData,
design = ~ condition)
# Parameters
set.seed(42)  # reproducibility
n_genes <- 20000   # number of genes
n_samples <- 4     # 2 control, 2 treated
total_counts <- 1013912
# Simulate counts from a negative binomial distribution
raw_counts <- matrix(
rnbinom(n_genes * n_samples, mu = 50, size = 1/0.2),  # mean=50, dispersion=0.2
nrow = n_genes,
ncol = n_samples
)
head(raw_counts)
# Scale counts so total sum matches exactly 1,013,912
scale_factor <- total_counts / sum(raw_counts)
scale_factor
counts_scaled <- round(raw_counts * scale_factor)
head(counts_scaled)
# Assign gene IDs
rownames(counts_scaled) <- paste0("Gene", seq_len(n_genes))
colnames(counts_scaled) <- c("control_rep1", "control_rep2", "treated_rep1", "treated_rep2")
head(counts_scaled)
# Create sample metadata
colData <- data.frame(
condition = factor(c("control", "control", "treated", "treated")),
replicate = c(1, 2, 1, 2)
)
rownames(colData) <- colnames(counts_scaled)
head(counts_scaled)
# Write simulated counts data into a CSV file
write.csv(counts_scaled, file = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 9/counts.csv")
# Example: Visualizing Gene Expression Data
count_data <- read.csv("counts.csv")
head(count_data, n = 1)
# Change X column to Genes
names(count_data)[names(count_data) == 'X'] <- 'Genes'
head(count_data, n = 1)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData,
design = ~ condition)
# Create sample metadata
colData <- data.frame(
condition = factor(c("control", "control", "treated", "treated")),
replicate = c(1, 2, 1, 2)
)
rownames(colData) <- colnames(counts_scaled)
# Parameters
set.seed(42)  # reproducibility
n_genes <- 20000   # number of genes
n_samples <- 4     # 2 control, 2 treated
total_counts <- 1013912
# Simulate counts from a negative binomial distribution
raw_counts <- matrix(
rnbinom(n_genes * n_samples, mu = 50, size = 1/0.2),  # mean=50, dispersion=0.2
nrow = n_genes,
ncol = n_samples
)
head(raw_counts)
# Scale counts so total sum matches exactly 1,013,912
scale_factor <- total_counts / sum(raw_counts)
scale_factor
counts_scaled <- round(raw_counts * scale_factor)
head(counts_scaled)
# Assign gene IDs
rownames(counts_scaled) <- paste0("Gene", seq_len(n_genes))
colnames(counts_scaled) <- c("control_rep1", "control_rep2", "treated_rep1", "treated_rep2")
head(counts_scaled)
# Create sample metadata
colData <- data.frame(
condition = factor(c("control", "control", "treated", "treated")),
replicate = c(1, 2, 1, 2)
)
rownames(colData) <- colnames(counts_scaled)
head(counts_scaled)
# Write simulated counts data into a CSV file
write.csv(counts_scaled, file = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 9/counts.csv")
# Example: Visualizing Gene Expression Data
count_data <- read.csv("counts.csv")
head(count_data, n = 1)
# Change X column to Genes
names(count_data)[names(count_data) == 'X'] <- 'Genes'
head(count_data, n = 1)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData,
design = ~ condition)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = counts_scaled,
colData = colData,
design = ~ condition)
class(counts_scaled)
class(count_data)
# Convert dataframe count_data back to matrix
count_data = as.matrix(count_data)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData,
design = ~ condition)
class(count_data)
class(counts_scaled)
# Write simulated counts data into a CSV file
write.csv(counts_scaled, file = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 9/counts.csv")
# Example: Visualizing Gene Expression Data
count_data <- read.csv("counts.csv")
head(count_data, n = 1)
class(count_data)
count_data = as.matrix(count_data)
class(count_data)
View(count_data)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_data,
colData = colData,
design = ~ condition)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = count_scaled,
colData = colData,
design = ~ condition)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = counts_scaled,
colData = colData,
design = ~ condition)
class(counts_scaled)
# Write simulated counts data into a CSV file
write.csv(counts_scaled, file = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 9/counts.csv")
# Example: Visualizing Gene Expression Data
count_data <- read.csv("counts.csv", row.names = 1, check.names = FALSE)
head(count_data, n = 1)
# Change X column to Genes
names(count_data)[names(count_data) == 'X'] <- 'Genes'
head(count_data, n = 1)
# Convert to numeric matrix
counts_mat <- as.matrix(count_data)
# Ensure numeric (avoid factors/characters)
storage.mode(counts_mat) <- "numeric"
# If counts were scaled and you need integers for DESeq2:
counts_mat <- round(counts_mat)
View(counts_mat)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = counts_mat,
colData = colData,
design = ~ condition)
# Create DESeq2 object
dds <- DESeqDataSetFromMatrix(countData = counts_mat,
colData = colData,
design = ~ condition)
dds
# Run the DESeq analysis
dds <- DESeq(dds)
dds
results <- results(dds)
results
head(results)
sig_results <- results[which(results$padj < 0.05 & abs(results$log2FoldChange)> 1),]
sig_results
View(sig_results)
View(raw_counts)
View(results)
head(results, n = 20)
sig_results <- results[which(results$padj < 0.10 & abs(results$log2FoldChange)> 1),]
sig_results
sig_results <- results[which(results$padj < 0.10 & abs(results$log2FoldChange)> 0.5),]
sig_results
sig_results <- results[which(results$padj < 0.50 & abs(results$log2FoldChange)> 0.5),]
sig_results
sig_results <- results[which(results$padj < 0.50 & abs(results$log2FoldChange)> 0.1),]
sig_results
sig_results <- results[which(results$padj < 0.90 & abs(results$log2FoldChange)> 0.1),]
sig_results
sig_results <- results[which(results$padj < 0.999 & abs(results$log2FoldChange)> 0.1),]
sig_results
sig_results <- results[which(results$padj < 0.05 & abs(results$log2FoldChange)> 1),]
sig_results
View(dds)
dds@assays
assay(dds)
View(sig_results)
head(results, n = 20)
sig_results <- results[which(results$padj < 0.99 & abs(results$log2FoldChange)> 0.1),]
sig_results
sig_results <- results[which(results$padj < 0.999 & abs(results$log2FoldChange)> 0.1),]
sig_results
sig_results <- results[which(results$padj < 0.998 & abs(results$log2FoldChange)> 0.1),]
sig_results
sig_results <- results[which(results$padj < 0.997 & abs(results$log2FoldChange)> 0.1),]
sig_results
sig_results <- results[which(results$padj < 0.998 & abs(results$log2FoldChange)> 0.3),]
sig_results
sig_results <- results[which(results$padj < 0.998 & abs(results$log2FoldChange)> 0.4),]
sig_results
sig_results <- results[which(results$padj < 0.998 & abs(results$log2FoldChange)> 0.7),]
sig_results
sig_results <- results[which(results$padj < 0.998 & abs(results$log2FoldChange)> 0.9),]
sig_results
sig_results <- results[which(results$padj < 0.998 & abs(results$log2FoldChange)> 1),]
sig_results
sig_results <- results[which(results$padj < 0.998 & abs(results$log2FoldChange)> 2),]
sig_results
# Heat map
pheatmap(assay(dds)[sig_results,], cluster_rows = TRUE, cluster_cols = TRUE)
# Load Library
library(pheatmap)
# Heat map
pheatmap(assay(dds)[sig_results,], cluster_rows = TRUE, cluster_cols = TRUE)
assay(dds)
assay(dds)[sig_results,]
sig_results
# Heat map
pheatmap(assay(dds)[sig_results,], cluster_rows = TRUE, cluster_cols = TRUE)
sig_results <- rownames(results)[which(results$padj < 0.998 & abs(results$log2FoldChange)> 2),]
# Filter significant genes
sig_genes <- rownames(res)[which(res$padj < 0.05 & !is.na(res$padj))]
# Filter significant genes
sig_genes <- rownames(results)[which(res$padj < 0.05 & !is.na(res$padj))]
# Filter significant genes
sig_genes <- rownames(results)[which(results$padj < 0.05 & !is.na(results$padj))]
sig_results <- rownames(results)[which(results$padj < 0.998 & abs(results$log2FoldChange)> 2)]
sig_results
# Heat map
pheatmap(assay(dds)[sig_results,], cluster_rows = TRUE, cluster_cols = TRUE)
volcano_data <- as.data.frame(results)
ggplot(volcano_data, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(alpha = 0.5, size = 1.5) +
geom_point(data = subset(volcano_data, padj < 0.998), color = "red") +
labs(title = "Volcano Plot of Differential Gene Expression")
head(volcano_data)
ggplot(volcano_data, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(alpha = 0.5, size = 1.5) +
geom_point(data = subset(volcano_data, padj < 0.998 & log2FoldChange > 2), color = "red") +
labs(title = "Volcano Plot of Differential Gene Expression")
ggplot(volcano_data, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(alpha = 0.5, size = 1.5) +
geom_point(data = subset(volcano_data, padj < 0.998 & abs(log2FoldChange) > 2), color = "red") +
labs(title = "Volcano Plot of Differential Gene Expression")
dim(subset(volcano_data, padj < 0.998 & abs(log2FoldChange) > 2))
dim(subset(volcano_data, padj < 0.998 & abs(log2FoldChange) > 3))
ggplot(volcano_data, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(alpha = 0.5, size = 1.5) +
geom_point(data = subset(volcano_data, padj < 0.998 & abs(log2FoldChange) > 1.5), color = "red") +
labs(title = "Volcano Plot of Differential Gene Expression")
