pdata=pData(bot)
head(pdata)
edata=as.matrix(exprs(bot))
head(edata)
fdata = fData(bot)
head(fdata)
ls()
# 7. Log2 transform and removing lowly expressed genes
edata = log2(as.matrix(edata) + 1)
edata = edata[rowMeans(edata) > 10, ]
# 8. Calculating the F-statistic and p-values using the gene filter package
fstats_obj = rowFtests(edata,as.factor(pdata$strain))
hist(fstats_obj$p.value,col=2)
# 9. Construct an adjusted model using the edge package, Strain (variable of interest),
# Lane (adjustment variable), model is not moderated (may get inflated statistics)
edge_study = build_study(edata, grp = pdata$strain,
adj.var = as.factor(pdata$lane.number))
de_obj = lrt(edge_study)
# 9. Construct an adjusted model using the edge package, Strain (variable of interest),
# Lane (adjustment variable), model is not moderated (may get inflated statistics)
edge_study = build_study(edata, grp = pdata$strain, adj.var = as.factor(pdata$lane.number))
de_obj = lrt(edge_study)
# 9. Construct an adjusted model using the edge package, Strain (variable of interest),
# Lane (adjustment variable), model is not moderated (may get inflated statistics)
edge_study = build_study(edata, grp = pdata$strain, adj.var = as.factor(pdata$lane.number))
de_obj = lrt(edge_study)
# 4. Load Libraries
library(goseq)
# 5. Display data
head(supportedGenomes())
detach("package:geneLenDataBase", unload = TRUE)
detach("package:geneLenDataBase", unload = TRUE)
detach("package:goseq", unload = TRUE)
detach("package:geneLenDataBase", unload = TRUE)
# 1. Installing Bioconductor package
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
# BiocManager::install()
# 2. Installing qvalue
# BiocManager::install("goseq")
# 3. Troubleshooting installing packages
# BiocManager::valid()
# 4. Load Libraries
library(goseq)
# 5. Display data
head(supportedGenomes())
# 6. Display data – Available cases
head(supportedGeneIDs())
# 7. Load data from goseq package
temp_data =read.table(system.file("extdata","Li_sum.txt",
package="goseq"),sep="\t",
header=TRUE,
stringsAsFactors=FALSE)
# 8. First row of the data set
temp_data[1,]
# 9. Remove 1st column of data set and replace it with rownames = gene names
expr= temp_data[,-1]
rownames(expr) = temp_data[,1]
# 10. Remove lowly expressed genes
expr = expr[rowMeans(expr) > 5,]
# 11. Create a group variable, the data doesn't have a group variable
grp=factor(rep(c("Control","Treated"),times=c(4,3)))
grp
# 12. Create a pdata (phenotype) object with just the grp variable in it
pdata  = data.frame(grp)
pdata[1,]
# 13. Passing expression(expr), phenotype data(pdata) and the grp variable you want to model
de = DESeqDataSetFromMatrix(expr, pdata, ~grp)
# 13. Passing expression(expr), phenotype data(pdata) and the grp variable you want to model
library(DESeq2)
de = DESeqDataSetFromMatrix(expr, pdata, ~grp)
# 14. Use DESeq to identify differentially expressed genes
de_fit = DESeq(de)
# 15. Calculate the results using the results function
de_results = results(de_fit)
# 16. Display differentially expressed results
head(de_fit)
# 17. Remove the genes where we can’t calculate a statistic
# 17. A. Filter genes that are differentially expressed < 0.05 (FDR)
genes = as.integer(de_results$padj < 0.05)
# 17. B. Remove data were there wasn't enough data
not_na = !is.na(genes)
# 17. C. Apply row names to match genes to genomic data
names(genes) = rownames(expr)
# 17. D. Remove genes we can't calculate a statistic for
genes = genes[not_na]
# 18. We need to set up a weighting function for all the genes in that genome
pwf=nullp(genes,"hg19","ensGene")
# 19. Use goseq package to calculate the statistics for enrichment
GO.wall=goseq(pwf,"hg19","ensGene")
# 20. Display results
head(GO.wall)
# 21. Selecting a specific category of interest for your analysis
GO.MF=goseq(pwf,"hg19","ensGene",test.cats=c("GO:MF"))
head(GO.MF)
# 8. First row of the data set
temp_data[1,]
# 7. Load data from goseq package
temp_data =read.table(system.file("extdata","Li_sum.txt",
package="goseq"),sep="\t",
header=TRUE,
stringsAsFactors=FALSE)
# 8. First row of the data set
temp_data[1,]
# 9. Remove 1st column of data set and replace it with rownames = gene names
expr= temp_data[,-1]
expr
rownames(expr) = temp_data[,1]
temp_data[,1]
# 10. Remove lowly expressed genes
expr = expr[rowMeans(expr) > 5,]
# 11. Create a group variable, the data doesn't have a group variable
grp=factor(rep(c("Control","Treated"),times=c(4,3)))
grp
# 12. Create a pdata (phenotype) object with just the grp variable in it
pdata  = data.frame(grp)
pdata[1,]
head(pdata)
head(expr)
# 13. Passing expression(expr), phenotype data(pdata) and the grp variable you want to model
library(DESeq2)
de = DESeqDataSetFromMatrix(expr, pdata, ~grp)
head(de)
# 16. Display differentially expressed results
head(de_results)
# 16. Display differentially expressed results
head(de_results)
# 6. Load in data from a connection
con = url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bodymap_eset.RData")
# 7. Close the connection
close(con)
# 8. Display body map expression set
ls()
# 9. Re-assign bodymap.eset to a smaller name
bm = bodymap.eset
# 5. C. I. Load in data from a connection
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
ls()
bot = bottomly.eset
bot
pdata_bot=pData(bot)
summary(edata)
summary(edata)
# 5. C. I. Load in data from a connection
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
ls()
bot = bottomly.eset
bot
pdata_bot=pData(bot)
library(BiocGenerics)
library(AnnotationDbi)
# 5. C. I. Load in data from a connection
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
ls()
bot = bottomly.eset
bot
pdata_bot=pData(bot)
head(pdata_bot)
fdata_bot = featureData(bot)
head(fdata_bot)
edata = exprs(bot)
head(edata, n=1)
summary(edata)
table(pdata$age)
table(pdata$age,useNA="ifany")
# 14. Displaying gender type information from phenotype data
table(pdata$gender)
# 5. C. I. Load in data from a connection
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
ls()
bot = bottomly.eset
bot
pdata_bot=pData(bot)
head(pdata_bot)
fdata_bot = featureData(bot)
head(fdata_bot)
edata = exprs(bot)
head(edata, n=1)
# 5. C. II. Check genomic data for NAs
is.na(edata)[1,]
library(tidyverse)
library(dplyr)
library(tibble)
# 5. C. III. Change expression set to a data frame
edata1 = as.data.frame(edata)
edata2 = as_tibble(edata)
edata3 = data.frame(edata)
knitr::opts_chunk$set(echo = TRUE)
install.packages("reticulate")
library(reticulate)
# py_install("Bio")
reticulate::repl_python()
reticulate::repl_python()
knitr::opts_chunk$set(echo = TRUE)
install.packages("reticulate")
library(reticulate)
# py_install("Bio")
reticulate::repl_python()
install.packages("reticulate")
library(reticulate)
# py_install("Bio")
reticulate::repl_python()
install.packages("reticulate")
library(reticulate)
# py_install("Bio")
reticulate::repl_python()
knitr::opts_chunk$set(echo = TRUE)
install.packages("reticulate")
library(reticulate)
# py_install("Bio")
reticulate::repl_python()
reticulate::repl_python()
knitr::opts_chunk$set(echo = TRUE)
install.packages("reticulate")
library(reticulate)
# py_install("Bio")
knitr::opts_chunk$set(echo = TRUE)
# C:\Users\Ajay_\AppData\Local\R\cache\R\reticulate\uv\cache\archive-v0\Y4pwbi6LQG6ixjCEO2rPq\Lib\site-packages
pip install pandas
# C:\Users\Ajay_\AppData\Local\R\cache\R\reticulate\uv\cache\archive-v0\Y4pwbi6LQG6ixjCEO2rPq\Lib\site-packages
install.packages("pip")
install.packages("reticulate")
library(reticulate)
# py_install("Bio")
reticulate::repl_python()
reticulate::repl_python()
setwd("D:/Ajay Files/R Programming for Bioinformatics/Chapter 8")
# Define the file path
fastq_file <- "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/Thale Cress genome/SRR7508943.fastq/SRR7508943.fastq"
# Load the FASTQ file
fastq_data <- readFastq(fastq_file)
# Load library
library(ShortRead)
library(dada2)
# Load the FASTQ file
fastq_data <- readFastq(fastq_file)
# Inspect the first few reads
head(fastq_data)
# Plot read quality
plotQualityProfile(fastq_file, n = 1013912)
# Load Libraries
library(Rsubread)
library(seqinr)
# Specify input and output file paths
input_file <- "D:\Ajay Files\R Programming for Bioinformatics\Chapter 8\Thale Cress genome\ncbi_dataset\ncbi_dataset\data\GCA_000001735.2\GCA_000001735.2_TAIR10.1_genomic.fna"
# Specify input and output file paths
input_file <- "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/Thale Cress genome/ncbi_dataset/ncbi_dataset/data/GCA_000001735.2/GCA_000001735.2_TAIR10.1_genomic.fna"
output_file <- "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/GCA_000001735.2_TAIR10.1_genomic.fa"
# Read sequences from the .fna file
sequences <- read.fasta(file = input_file, seqtype = "DNA", as.string = TRUE, forceDNAtolower = FALSE)
# Write sequences to a .fa file
write.fasta(sequences = sequences,
names = names(sequences),
file.out = output_file)
# Read the original FASTA
Thale_fa <- readDNAStringSet("D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/GCA_000001735.2_TAIR10.1_genomic.fa")
# Write into a new FASTA with line length 60
writeXStringSet(Thale_fa, "Thale_genome_fixed.fasta", width=60)
# Build index from a reference genome FASTA file
# Example: Thale genome FASTA
buildindex(
basename = "Thale_index",
reference = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/Thale_genome_fixed.fasta"
)
# Aligning RNA-Seq reads
align(
index = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/Thale_index.log",  # basename from buildindex()
readfile1 = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/Thale Cress genome/SRR7508943.fastq/SRR7508943.fastq",
output_file = "Thale_aligned.bam"
)
# Aligning RNA-Seq reads
align(
index = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/Thale_index",  # basename from buildindex()
readfile1 = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/Thale Cress genome/SRR7508943.fastq/SRR7508943.fastq",
output_file = "Thale_aligned.bam"
)
# Path to annotation file
annot <- "D:\Ajay Files\R Programming for Bioinformatics\Chapter 8\Thale Cress genome\ncbi_dataset\ncbi_dataset\data\GCA_000001735.2\genomic.gtf"
# Path to annotation file
annot <- "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/Thale Cress genome/ncbi_dataset/ncbi_dataset/data/GCA_000001735.2/genomic.gtf"
# Count reads mapping to genes
counts <- featureCounts("Thale_aligned.bam", annot.ext = )
count_matrix <- counts$counts
head(count_matrix)
View(count_matrix)
count_matrix
counts
View(count_matrix)
View(counts)
# Count reads mapping to genes
counts <- featureCounts("Thale_aligned.bam", annot.ext = annot)
# Count reads mapping to genes
counts <- featureCounts("Thale_aligned.bam", annot.ext = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/Thale Cress genome/ncbi_dataset/ncbi_dataset/data/GCA_000001735.2/genomic.gtf")
# Count reads mapping to genes
counts <- featureCounts("Thale_aligned.bam", annot.ext = "genomic.gtf")
# Count reads mapped to genes using a GTF annotation
counts <- featureCounts(
files = "Thale_aligned.bam",       # BAM file
annot.ext = "genomic.gtf",         # GTF file
isGTFAnnotationFile = TRUE,        # Tell featureCounts it's a GTF
GTF.featureType = "exon",          # Count exons (common for RNA-seq)
GTF.attrType = "gene_id",          # Group by gene_id
useMetaFeatures = TRUE,            # Sum counts per gene
isPairedEnd = TRUE                 # Set to FALSE if single-end
)
# Count reads mapped to genes using a GTF annotation
counts <- featureCounts(
files = "Thale_aligned.bam",       # BAM file
annot.ext = "genomic.gtf",         # GTF file
isGTFAnnotationFile = TRUE,        # Tell featureCounts it's a GTF
GTF.featureType = "exon",          # Count exons (common for RNA-seq)
GTF.attrType = "gene_id",          # Group by gene_id
useMetaFeatures = TRUE,            # Sum counts per gene
isPairedEnd = FALSE                 # Set to FALSE if single-end
)
# Extract the count matrix
count_matrix <- counts$counts
head(count_matrix)
View(count_matrix)
counts
# Summary of count object
head(count)
# Summary of count object
head(count)
# Summary of count object
head(counts)
# Summary of count object
summary(counts)
# Extract the count matrix
count_matrix <- counts$counts
head(count_matrix)
summary(count_matrix)
# Count matrix
counts1 <- data.frame(
Thale_aligned.bam = c(7, 22, 0, 8, 43, 0),
row.names = c("AT1G01010", "AT1G01020", "AT1G03987", "AT1G01030", "AT1G01040", "AT1G03993")
)
counts1
# Create Sample metadata (colData)
colData <- data.frame(
condition = factor(c("control", "treated", "control", "treated")),
replicate = c(1, 1, 2, 2)
)
# Create Sample metadata (colData)
colData <- data.frame(
condition = factor(c("control", "treated", "control", "treated")),
replicate = c(1, 1, 2, 2)
)
colData
row.names(colData) <- colnames(counts)
# Define the design formula
dds <- DESeqDataSetFromMatrix(
countData = counts1,
colData = colData,
design = ~ condition
)
# Load library
library(DESeq2)
# Define the design formula
dds <- DESeqDataSetFromMatrix(
countData = counts1,
colData = colData,
design = ~ condition
)
# Count matrix
counts1 <- data.frame(
Thale_aligned.bam = c(7, 22, 0, 8, 43, 0),
row.names = c("AT1G01010", "AT1G01020", "AT1G03987", "AT1G01030", "AT1G01040", "AT1G03993")
)
counts1
# Create Sample metadata (colData)
colData <- data.frame(
condition = factor("control")
)
row.names(colData) <- colnames(counts1)
# Define the design formula
library(DESeq2)
dds <- DESeqDataSetFromMatrix(
countData = counts1,
colData = colData,
design = ~ condition
)
# Parameters
set.seed(42)  # reproducibility
n_genes <- 20000   # number of genes
n_samples <- 4     # 2 control, 2 treated
total_counts <- 1013912
# Simulate counts from a negative binomial distribution
raw_counts <- matrix(
rnbinom(n_genes * n_samples, mu = 50, size = 1/0.2),  # mean=50, dispersion=0.2
nrow = n_genes,
ncol = n_samples
)
head(raw_counts)
# Scale counts so total sum matches exactly 1,013,912
scale_factor <- total_counts / sum(raw_counts)
scale_factor
counts_scaled <- round(raw_counts * scale_factor)
counts_scaled
head(raw_counts)
# Scale counts so total sum matches exactly 1,013,912
scale_factor <- total_counts / sum(raw_counts)
scale_factor
counts_scaled <- round(raw_counts * scale_factor)
head(counts_scaled)
# Assign gene IDs
rownames(counts_scaled) <- paste0("Gene", seq_len(n_genes))
colnames(counts_scaled) <- c("control_rep1", "control_rep2", "treated_rep1", "treated_rep2")
head(counts_scaled)
# Create sample metadata
colData <- data.frame(
condition = factor(c("control", "control", "treated", "treated")),
replicate = c(1, 2, 1, 2)
)
rownames(colData) <- colnames(counts_scaled)
head(counts_scaled)
rownames(colData)
colnames(counts_scaled)
# Build DESeq2 object
dds <- DESeqDataSetFromMatrix(
countData = counts_scaled,
colData = colData,
design = ~ condition
)
head(dds)
View(dds)
# Run DESeq2
dds <- DESeq(dds)
dds
# Run DESeq2
dds <- DESeq(dds)
dds
res <- results(dds)
res
# Check total counts
sum(counts(dds))  # should be 1013912
# Load library
library(ggplot2)
# Create a volcano plot
results_df <- as.data.frame(res)
ggplot(results_df, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(alpha = 0.5) + theme_minimal() +
labs(title = "Volcano Plot", x = "-Log2 Fold Change P-value")
seq_len(n_genes)
install.packages("fastqcr")
# Load "fastqcr" package
library(fastqcr)
# Define the file path
fastq_file <- "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/Thale Cress genome/SRR7508943.fastq/SRR7508943.fastq"
# Load the FASTQ file
fastq_data <- readFastq(fastq_file)
# Inspect the first few reads
head(fastq_data)
qc <- qc(fastq_data)
qc <- fastqc(fastq_data)
qc <- fastqc(fq.dir = fastq_file)
qc <- fastqc(fq.dir = "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/Thale Cress genome/SRR7508943.fastq/")
library(ShortRead)
fq <- readFastq(fastq_file)
qa <- qa(fq)
qa <- qa(fastq_file)
report(qa, dest = "QA_Report")
report
print(report)
view(report)
view(report_html(index.html))
report_html(index.html)
report(qa, dest = "QA_Report")
plot(qa)
qa_summary <- QA(qa)
browseURL(file.path("QA_Report", "D:\Ajay Files\R Programming for Bioinformatics\Chapter 8\QA_Report\index.html"))
browseURL(file.path("QA_Report", "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/QA_Report/index.html"))
browseURL(file.path("QA_Report", "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/QA_Report/index.html"))
fq <- readFastq(fastq_file)
qa <- qa(fastq_file)
report(qa, dest = "QA_Report")
browseURL(file.path("QA_Report", "D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/QA_Report/index.html"))
browseURL("D:/Ajay Files/R Programming for Bioinformatics/Chapter 8/QA_Report/index.html",
browser = "C:/Program Files/Internet Explorer/en-GB/ieinstal.exe.mui")
View(counts)
counts
counts
class(counts)
View(count_matrix)
View(counts)
View(count_matrix)
class(counts_scaled)
View(counts)
View(counts_scaled)
count_matrix_1 <- as.matrix(counts_scaled$counts)
# Convert count data to a matrix and set row and column names.
count_matrix_1 <- as.matrix(counts$counts)
rownames(count_matrix_1) <- counts$annotation$GeneID
colnames(count_matrix_1) <- counts$annotation$SampleID
View(count_matrix_1)
head(count_matrix_1)
class(count_matrix_1)
# Convert count data to a matrix and set row and column names.
class(counts)
count_matrix_1 <- as.matrix(counts$counts)
rownames(count_matrix_1) <- counts$annotation$GeneID
colnames(count_matrix_1) <- counts$annotation$SampleID
head(count_matrix_1)
class(count_matrix_1)
